<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.28.6">
    <meta name="project" content="Axon v0.2.0">

    <title>Your first Axon model — Axon v0.2.0</title>
    <link rel="stylesheet" href="dist/html-elixir-5CLCQQME.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-E7651553.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-PLW5RNNI.js"></script>


  </head>
  <body data-type="extras" class="page-livemd">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="Axon.html">
        <img src="assets/logo.png" alt="Axon" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="Axon.html" class="sidebar-projectName" translate="no">
Axon
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.2.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/elixir-nx/axon/blob/v0.2.0/guides/model_creation/your_first_axon_model.livemd#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span>Your first Axon model</span>
</h1>

  <div class="livebook-badge-container">
    <a href="#" class="livebook-badge">
      <img src="https://livebook.dev/badge/v1/blue.svg" alt="Run in Livebook" width="150" />
    </a>
  </div>

<pre><code class="makeup elixir" translate="no"><span class="nc">Mix</span><span class="o">.</span><span class="n">install</span><span class="p" data-group-id="7508504387-1">(</span><span class="p" data-group-id="7508504387-2">[</span><span class="w">
  </span><span class="p" data-group-id="7508504387-3">{</span><span class="ss">:axon</span><span class="p">,</span><span class="w"> </span><span class="ss">github</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;elixir-nx/axon&quot;</span><span class="p" data-group-id="7508504387-3">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7508504387-4">{</span><span class="ss">:nx</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.3.0&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">github</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;elixir-nx/nx&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">sparse</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nx&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">override</span><span class="p">:</span><span class="w"> </span><span class="no">true</span><span class="p" data-group-id="7508504387-4">}</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="7508504387-5">{</span><span class="ss">:kino</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&gt; 0.7.0&quot;</span><span class="p" data-group-id="7508504387-5">}</span><span class="w">
</span><span class="p" data-group-id="7508504387-2">]</span><span class="p" data-group-id="7508504387-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="ss">:ok</span></code></pre><h2 id="your-first-model" class="section-heading">
  <a href="#your-first-model" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">your-first-model</p>
  </a>
  Your first model
</h2>
<p>Axon is a library for creating and training neural networks in Elixir. Everything in Axon centers around the <code class="inline">%Axon{}</code> struct which represents an instance of an Axon model.</p><p>Models are just graphs which represent the transformation and flow of input data to a desired output. Really, you can think of models as representing a single computation or function. An Axon model, when executed, takes data as input and returns transformed data as output.</p><p>All Axon models start with a declaration of input nodes. These are the root nodes of your computation graph, and correspond to the actual input data you want to send to Axon:</p><pre><code class="makeup elixir" translate="no"><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">input</span><span class="p" data-group-id="2791676653-1">(</span><span class="s">&quot;data&quot;</span><span class="p" data-group-id="2791676653-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="8340593281-1">#</span><span class="nc" data-group-id="8340593281-1">Axon</span><span class="p" data-group-id="8340593281-1">&lt;</span><span class="w">
  </span><span class="ss">inputs</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="8340593281-2">%{</span><span class="s">&quot;data&quot;</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="no">nil</span><span class="p" data-group-id="8340593281-2">}</span><span class="w">
  </span><span class="ss">outputs</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data&quot;</span><span class="w">
  </span><span class="ss">nodes</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="p" data-group-id="8340593281-1">&gt;</span></code></pre><p>Technically speaking, <code class="inline">input</code> is now a valid Axon model which you can inspect, execute, and initialize. You can visualize how data flows through the graph using <a href="Axon.Display.html#as_graph/2"><code class="inline">Axon.Display.as_graph/2</code></a>:</p><pre><code class="makeup elixir" translate="no"><span class="n">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="2495056391-1">(</span><span class="p" data-group-id="2495056391-2">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="2495056391-2">}</span><span class="p">,</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="2495056391-1">)</span><span class="w">
</span><span class="nc">Axon.Display</span><span class="o">.</span><span class="n">as_graph</span><span class="p" data-group-id="2495056391-3">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">template</span><span class="p" data-group-id="2495056391-3">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="n">graph</span><span class="w"> </span><span class="nc">TD</span><span class="p">;</span><span class="w">
</span><span class="mi">3</span><span class="p" data-group-id="7152412822-1">[</span><span class="o">/</span><span class="s">&quot;data (:input) {2, 8}&quot;</span><span class="o">/</span><span class="p" data-group-id="7152412822-1">]</span><span class="p">;</span><span class="w">
</span><span class="p">;</span></code></pre><p>Notice the execution flow is just a single node, because your graph only consists of an input node! You pass data in and the model spits the same data back out, without any intermediate transformations.</p><p>You can see this in action by actually executing your model. You can build the <code class="inline">%Axon{}</code> struct into it's <code class="inline">initialization</code> and <code class="inline">forward</code> functions by calling <a href="Axon.html#build/2"><code class="inline">Axon.build/2</code></a>. This pattern of &quot;lowering&quot; or transforming the <code class="inline">%Axon{}</code> data structure into other functions or representations is very common in Axon. By simply traversing the data structure, you can create useful functions, execution visualizations, and more!</p><pre><code class="makeup elixir" translate="no"><span class="p" data-group-id="7946983413-1">{</span><span class="n">init_fn</span><span class="p">,</span><span class="w"> </span><span class="n">predict_fn</span><span class="p" data-group-id="7946983413-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">Axon</span><span class="o">.</span><span class="n">build</span><span class="p" data-group-id="7946983413-2">(</span><span class="n">input</span><span class="p" data-group-id="7946983413-2">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="3421244698-1">{</span><span class="p" data-group-id="3421244698-2">#</span><span class="nc" data-group-id="3421244698-2">Function</span><span class="p" data-group-id="3421244698-2">&lt;</span><span class="mf">137.55749718</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Nx.Defn</span><span class="o">.</span><span class="n">wrap_arity</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="3421244698-2">&gt;</span><span class="p">,</span><span class="w">
 </span><span class="p" data-group-id="3421244698-3">#</span><span class="nc" data-group-id="3421244698-3">Function</span><span class="p" data-group-id="3421244698-3">&lt;</span><span class="mf">137.55749718</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">Nx.Defn</span><span class="o">.</span><span class="n">wrap_arity</span><span class="o">/</span><span class="mi">2</span><span class="p" data-group-id="3421244698-3">&gt;</span><span class="p" data-group-id="3421244698-1">}</span></code></pre><p>Notice that <a href="Axon.html#build/2"><code class="inline">Axon.build/2</code></a> returns a tuple of <code class="inline">{init_fn, predict_fn}</code>. <code class="inline">init_fn</code> has the signature:</p><pre><code class="makeup elixir" translate="no"><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="6707436674-1">(</span><span class="n">template</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="6707436674-2">(</span><span class="n">tensor</span><span class="p" data-group-id="6707436674-2">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tensor</span><span class="p">,</span><span class="w"> </span><span class="n">initial_params</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="6707436674-1">)</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="6707436674-3">(</span><span class="n">tensor</span><span class="p" data-group-id="6707436674-3">)</span></code></pre><p>while <code class="inline">predict_fn</code> has the signature:</p><pre><code class="makeup elixir" translate="no"><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="9191935317-1">(</span><span class="n">params</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="9191935317-2">(</span><span class="n">tensor</span><span class="p" data-group-id="9191935317-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">map</span><span class="p" data-group-id="9191935317-3">(</span><span class="n">tensor</span><span class="p" data-group-id="9191935317-3">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tensor</span><span class="p" data-group-id="9191935317-1">)</span></code></pre><p><code class="inline">init_fn</code> returns all of your model's trainable parameters and state. You need to pass a template of the expected inputs because the shape of certain model parameters often depend on the shape of model inputs. You also need to pass any initial parameters you want your model to start with. This is useful for things like transfer learning, which you can read about in another guide.</p><p><code class="inline">predict_fn</code> returns transformed inputs from your model's trainable parameters and the given inputs.</p><pre><code class="makeup elixir" translate="no"><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">init_fn</span><span class="o">.</span><span class="p" data-group-id="1439151465-1">(</span><span class="nc">Nx</span><span class="o">.</span><span class="n">template</span><span class="p" data-group-id="1439151465-2">(</span><span class="p" data-group-id="1439151465-3">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="1439151465-3">}</span><span class="p">,</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="1439151465-2">)</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1439151465-4">%{</span><span class="p" data-group-id="1439151465-4">}</span><span class="p" data-group-id="1439151465-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="0976247940-1">%{</span><span class="p" data-group-id="0976247940-1">}</span></code></pre><p>In this example, you use <a href="https://hexdocs.pm/nx/0.3.0/Nx.html#template/2"><code class="inline">Nx.template/2</code></a> to create a <em>template tensor</em>, which is a placeholder that does not actually consume any memory. Templates are useful for initialization because you don't actually need to know anything about your inputs other than their shape and type.</p><p>Notice <code class="inline">init_fn</code> returned an empty map because your model does not have any trainable parameters. This should make sense because it's just an input layer.</p><p>Now you can pass these trainable parameters to <code class="inline">predict_fn</code> along with some input to actually execute your model:</p><pre><code class="makeup elixir" translate="no"><span class="n">predict_fn</span><span class="o">.</span><span class="p" data-group-id="4393876387-1">(</span><span class="n">params</span><span class="p">,</span><span class="w"> </span><span class="nc">Nx</span><span class="o">.</span><span class="n">iota</span><span class="p" data-group-id="4393876387-2">(</span><span class="p" data-group-id="4393876387-3">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p" data-group-id="4393876387-3">}</span><span class="p">,</span><span class="w"> </span><span class="ss">type</span><span class="p">:</span><span class="w"> </span><span class="ss">:f32</span><span class="p" data-group-id="4393876387-2">)</span><span class="p" data-group-id="4393876387-1">)</span></code></pre><pre><code class="makeup output" translate="no"><span class="p" data-group-id="9131325870-1">#</span><span class="nc" data-group-id="9131325870-1">Nx.Tensor</span><span class="p" data-group-id="9131325870-1">&lt;</span><span class="w">
  </span><span class="n">f32</span><span class="p" data-group-id="9131325870-2">[</span><span class="mi">1</span><span class="p" data-group-id="9131325870-2">]</span><span class="p" data-group-id="9131325870-3">[</span><span class="mi">8</span><span class="p" data-group-id="9131325870-3">]</span><span class="w">
  </span><span class="p" data-group-id="9131325870-4">[</span><span class="w">
    </span><span class="p" data-group-id="9131325870-5">[</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">,</span><span class="w"> </span><span class="mf">4.0</span><span class="p">,</span><span class="w"> </span><span class="mf">5.0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.0</span><span class="p">,</span><span class="w"> </span><span class="mf">7.0</span><span class="p" data-group-id="9131325870-5">]</span><span class="w">
  </span><span class="p" data-group-id="9131325870-4">]</span><span class="w">
</span><span class="p" data-group-id="9131325870-1">&gt;</span></code></pre><p>And your model just returned the given input, as expected!</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="api-reference.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
API Reference
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="sequential_models.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Sequential models
        </span>
      </a>

  </div>
</div>
      <footer class="footer">

          <p>
            On Hex.pm:

            <span class="line">
              <a href="https://hex.pm/packages/axon/0.2.0" class="line footer-hex-package">Package</a>
              <a href="https://preview.hex.pm/preview/axon/0.2.0" class="line">Preview</a>

                <a href="https://preview.hex.pm/preview/axon/0.2.0/show/guides/model_creation/your_first_axon_model.livemd">(current file)</a>

            </span>

            <button class="a-main line footer-button display-quick-switch">
              Search
            </button>
          </p>

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.28.6) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<!-- Render math with KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

<!-- Render diagrams with Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({ startOnLoad: false });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition, function (svgSource, bindListeners) {
        graphEl.innerHTML = svgSource;
        bindListeners && bindListeners(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  });
</script>

  </body>
</html>
