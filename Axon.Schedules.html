<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.28.6">
    <meta name="project" content="Axon v0.3.0">

    <title>Axon.Schedules â€” Axon v0.3.0</title>
    <link rel="stylesheet" href="dist/html-elixir-5CLCQQME.css" />

    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-X7YVL3G2.js"></script>
    <script src="dist/sidebar_items-3AA8413F.js"></script>

      <script src="docs_config.js"></script>

    <script async src="dist/html-PLW5RNNI.js"></script>


  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="Axon.html">
        <img src="assets/logo.png" alt="Axon" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="Axon.html" class="sidebar-projectName" translate="no">
Axon
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v0.3.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">Pages</a></li>

        <li><a id="modules-list-link" href="#full-list">Modules</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list" class="sidebar-fullList"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="settings display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>


    <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/lib/axon/schedules.ex#L1" title="View Source" class="view-source" rel="help">
      <i class="ri-code-s-slash-line" aria-hidden="true"></i>
      <span class="sr-only">View Source</span>
    </a>

  <span translate="no">Axon.Schedules</span> 
  <small class="app-vsn" translate="no">(Axon v0.3.0)</small>

</h1>


  <section id="moduledoc">
<p>Parameter Schedules.</p><p>Parameter schedules are often used to anneal hyperparameters
such as the learning rate during the training process. Schedules
provide a mapping from the current time step to a learning rate
or another hyperparameter.</p><p>Choosing a good learning rate and consequently a good learning
rate schedule is typically a process of trial and error. Learning
rates should be relatively small such that the learning curve
does not oscillate violently during the training process, but
not so small that learning proceeds too slowly. Using a
schedule slowly decreases oscillations during the training
process such that, as the model converges, training also
becomes more stable.</p><p>All of the functions in this module are implemented as
numerical functions and can be JIT or AOT compiled with
any supported <a href="https://hexdocs.pm/nx/0.4.0/Nx.html"><code class="inline">Nx</code></a> compiler.</p>
  </section>


  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
      Summary
    </h1>

  <div class="summary-functions summary">
    <h2>
      <a href="#functions">Functions</a>
    </h2>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#constant/1" translate="no">constant(opts \\ [])</a>

        </div>

          <div class="summary-synopsis"><p>Constant schedule.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#cosine_decay/1" translate="no">cosine_decay(opts \\ [])</a>

        </div>

          <div class="summary-synopsis"><p>Cosine decay schedule.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#exponential_decay/1" translate="no">exponential_decay(opts \\ [])</a>

        </div>

          <div class="summary-synopsis"><p>Exponential decay schedule.</p></div>

      </div>

      <div class="summary-row">
        <div class="summary-signature">
          <a href="#polynomial_decay/1" translate="no">polynomial_decay(opts \\ [])</a>

        </div>

          <div class="summary-synopsis"><p>Polynomial schedule.</p></div>

      </div>

  </div>

  </section>


  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
        <span class="sr-only">Link to this section</span>
      </a>
Functions
    </h1>
    <div class="functions-list">
<section class="detail" id="constant/1">

    <span id="constant/0"></span>

  <div class="detail-header">
    <a href="#constant/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">constant(opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/lib/axon/schedules.ex#L140" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Constant schedule.</p><p>$$\gamma(t) = \gamma_0$$</p><h2 id="constant/1-options" class="section-heading">
  <a href="#constant/1-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">options</p>
  </a>
  Options
</h2>
<ul><li><code class="inline">:init_value</code> - initial value. $\gamma_0$ in above formulation.
Defaults to <code class="inline">1.0e-2</code></li></ul>
  </section>
</section>
<section class="detail" id="cosine_decay/1">

    <span id="cosine_decay/0"></span>

  <div class="detail-header">
    <a href="#cosine_decay/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">cosine_decay(opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/lib/axon/schedules.ex#L107" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Cosine decay schedule.</p><p>$$\gamma(t) = \gamma_0 <em> (1 - \alpha)</em>(\frac{1}{2}(1 + \cos{\pi \frac{t}{k}})) + \alpha$$</p><h2 id="cosine_decay/1-options" class="section-heading">
  <a href="#cosine_decay/1-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">options</p>
  </a>
  Options
</h2>
<ul><li><code class="inline">:init_value</code> - initial value. $\gamma_0$  in above formulation.
Defaults to <code class="inline">1.0e-2</code></li><li><code class="inline">:decay_steps</code> - number of steps to apply decay for.
$k$ in above formulation. Defaults to <code class="inline">10</code></li><li><code class="inline">:alpha</code> - minimum value of multiplier adjusting learning rate.
$\alpha$ in above formulation. Defaults to <code class="inline">0.0</code></li></ul><h2 id="cosine_decay/1-references" class="section-heading">
  <a href="#cosine_decay/1-references" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">references</p>
  </a>
  References
</h2>
<ul><li><a href="https://openreview.net/forum?id=Skq89Scxx&noteId=Skq89Scxx">SGDR: Stochastic Gradient Descent with Warm Restarts</a></li></ul>
  </section>
</section>
<section class="detail" id="exponential_decay/1">

    <span id="exponential_decay/0"></span>

  <div class="detail-header">
    <a href="#exponential_decay/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">exponential_decay(opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/lib/axon/schedules.ex#L44" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Exponential decay schedule.</p><p>$$\gamma(t) = \gamma_0 * r^{\frac{t}{k}}$$</p><h2 id="exponential_decay/1-options" class="section-heading">
  <a href="#exponential_decay/1-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">options</p>
  </a>
  Options
</h2>
<ul><li><code class="inline">:init_value</code> - initial value. $\gamma$ in above formulation.
Defaults to <code class="inline">1.0e-2</code></li><li><code class="inline">:decay_rate</code> - rate of decay. $r$ in above formulation.
Defaults to <code class="inline">0.95</code></li><li><code class="inline">:transition_steps</code> - steps per transition. $k$ in above
formulation. Defaults to <code class="inline">10</code></li><li><code class="inline">:transition_begin</code> - step to begin transition. Defaults to <code class="inline">0</code></li><li><code class="inline">:staircase</code> - discretize outputs. Defaults to <code class="inline">false</code></li></ul>
  </section>
</section>
<section class="detail" id="polynomial_decay/1">

    <span id="polynomial_decay/0"></span>

  <div class="detail-header">
    <a href="#polynomial_decay/1" class="detail-link" title="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
      <span class="sr-only">Link to this function</span>
    </a>
    <h1 class="signature" translate="no">polynomial_decay(opts \\ [])</h1>

      <a href="https://github.com/elixir-nx/axon/blob/v0.3.0/lib/axon/schedules.ex#L165" class="view-source" rel="help" title="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
       <span class="sr-only">View Source</span>
     </a>


  </div>

  <section class="docstring">

<p>Polynomial schedule.</p><p>$$\gamma(t) = (\gamma_0 - \gamma_n) * (1 - \frac{t}{k})^p$$</p><h2 id="polynomial_decay/1-options" class="section-heading">
  <a href="#polynomial_decay/1-options" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i>
  <p class="sr-only">options</p>
  </a>
  Options
</h2>
<ul><li><code class="inline">:init_value</code> - initial value. $\gamma_0$ in above formulation.
Defaults to <code class="inline">1.0e-2</code></li><li><code class="inline">:end_value</code> - end value of annealed scalar. $\gamma_n$ in above formulation.
Defaults to <code class="inline">1.0e-3</code></li><li><code class="inline">:power</code> - power of polynomial. $p$ in above formulation. Defaults to <code class="inline">2</code></li><li><code class="inline">:transition_steps</code> - number of steps over which annealing takes place.
$k$ in above formulation. Defaults to <code class="inline">10</code></li></ul>
  </section>
</section>

    </div>
  </section>

      <footer class="footer">

          <p>
            On Hex.pm:

            <span class="line">
              <a href="https://hex.pm/packages/axon/0.3.0" class="line footer-hex-package">Package</a>
              <a href="https://preview.hex.pm/preview/axon/0.3.0" class="line">Preview</a>

                <a href="https://preview.hex.pm/preview/axon/0.3.0/show/lib/axon/schedules.ex">(current file)</a>

            </span>

            <button class="a-main line footer-button display-quick-switch">
              Search
            </button>
          </p>

        <p>
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.28.6) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>

<!-- Render math with KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css" integrity="sha384-t5CR+zwDAROtph0PXGte6ia8heboACF9R5l/DiY+WZ3P2lxNgvJkQk5n7GPvLMYw" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.js" integrity="sha384-FaFLTlohFghEIZkw6VGwmf9ISTubWAVYW8tG8+w2LAIftJEULZABrF9PPFv+tVkH" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/auto-render.min.js" integrity="sha384-bHBqxz8fokvgoJ/sc17HODNxa42TlaEhB+w8ZJXTc2nZf1VgEaFZeZvT4Mznfz0v" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

<!-- Render diagrams with Mermaid -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.3/dist/mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    mermaid.initialize({ startOnLoad: false });
    let id = 0;
    for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition, function (svgSource, bindListeners) {
        graphEl.innerHTML = svgSource;
        bindListeners && bindListeners(graphEl);
        preEl.insertAdjacentElement("afterend", graphEl);
        preEl.remove();
      });
    }
  });
</script>

  </body>
</html>
